type Mutation {
    sendPhoneOtp(input: SendPhoneOtpInput!): SendPhoneOtpOutput @resolver(class: "IDangerous\\PhoneOtpVerification\\Model\\Resolver\\SendPhoneOtp")
    verifyPhoneOtp(input: VerifyPhoneOtpInput!): VerifyPhoneOtpOutput @resolver(class: "IDangerous\\PhoneOtpVerification\\Model\\Resolver\\VerifyPhoneOtp")

    # Address/Checkout OTP flow (stateless via verification token)
    sendAddressPhoneOtp(input: SendPhoneOtpInput!): SendPhoneOtpOutput @resolver(class: "IDangerous\\PhoneOtpVerification\\Model\\Resolver\\SendAddressPhoneOtp")
    verifyAddressPhoneOtp(input: VerifyPhoneOtpInput!): VerifyAddressPhoneOtpOutput @resolver(class: "IDangerous\\PhoneOtpVerification\\Model\\Resolver\\VerifyAddressPhoneOtp")
}

type Query {
    phoneOtpStatus: PhoneOtpStatusOutput @resolver(class: "IDangerous\\PhoneOtpVerification\\Model\\Resolver\\PhoneOtpStatus")
}

extend input CustomerInput {
    phone_number: String
}

extend type Customer {
    phone_number: String @resolver(class: "IDangerous\\PhoneOtpVerification\\Model\\Resolver\\Customer\\PhoneNumber")
    phone_verified: Boolean @resolver(class: "IDangerous\\PhoneOtpVerification\\Model\\Resolver\\Customer\\PhoneVerified")
}

input SendPhoneOtpInput {
    phone_number: String!
}

input VerifyPhoneOtpInput {
    otp_code: String!
}

type SendPhoneOtpOutput {
    success: Boolean!
    message: String!
}

type VerifyPhoneOtpOutput {
    success: Boolean!
    message: String!
    phone_verified: Boolean
    customer_updated: Boolean
}

type VerifyAddressPhoneOtpOutput {
    success: Boolean!
    message: String!
    verification_token: String
    expires_in: Int
}

type PhoneOtpStatusOutput {
    has_pending_otp: Boolean!
    phone_number: String
    time_remaining: Int
    is_expired: Boolean!
}